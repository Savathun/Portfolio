import extract_links as el
import sqli_scanner as sqli
import subdomain_scanner as ss
import xss_scanner as xss

print("Enter the full url of the website you wish to scan:")
url = input()
url_start = url[: url.find('//') + 2]
url = url[url.find('//') + 2:]
if input('Scan for subdomains? (Y/N)') == 'Y':
    print('Scanning for subdomains...')
    with open("subdomains_discovered.txt", "w"):
        pass
    ss.main(url, 100, open('subdomains.txt').read().splitlines())
webpages_to_scan = set()
subdomains = open("subdomains_discovered.txt").readlines()
subdomains.append(url_start + url)
webpages_to_scan.add(url_start + url)
if input("Extract and scan internal links? (Y/N)") == 'Y':
    print('Extracting internal links...')
    for sub in subdomains:
        webpages_to_scan.update(el.main(sub))
if input('Scan for XSS vulnerability? (Y/N)') == 'Y':
    print("Scanning pages for cross-site scripting vulnerability...")
    for webpage in webpages_to_scan:
        if xss.scan_xss(webpage):
            print(webpage + ' is vulnerable to XSS')
        else:
            print(webpage + 'is secure against XSS.')
if input('Scan for SQL injection vulnerability? (Y/N)') == 'Y':
    print("Scanning pages for sql injection vulnerability...")
    for webpage in webpages_to_scan:
        sqli.main(webpage)
